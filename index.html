<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<title>Our Winter</title>

<style>
  body {
    margin: 0;
    font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Arial, sans-serif;
    background: #f4f4f6;
    color: #333;
  }

  .hidden { display: none; }

  /* ì¸íŠ¸ë¡œ ë¬¸ì¥ ìƒ‰ ê³ ì • */
  #intro {
    color: #000;   /* ê²€ì •ìƒ‰ */
  }

  /* ===== ì¸íŠ¸ë¡œ ===== */
  .center {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100vh;
    
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    text-align: center;
    
    background: #f4f4f6;
    z-index: 10;
  }
  
  .fade-out {
    animation: fadeOut 0.8s ease forwards;
  }
  
  @keyframes fadeOut {
    to {
      opacity: 0;
    }
  }

  .button-row {
    display: flex;
    flex-direction: row;
    justify-content: center;
    align-items: center;
    gap: 20px;
    margin-top: 16px;
    flex-wrap: nowrap;
  }

  button {
    padding: 8px 22px;
    border-radius: 20px;
    border: none;
    background: #ddd;
    cursor: pointer;
    font-size: 14px;
  }

  button:hover { background: #bbb; }

  /* ===== í™ˆ ===== */
  #home {
    padding: 20px;
    max-width: 360px;
    margin: 0 auto;
  }

  .dday {
    background: #fff;
    border-radius: 14px;
    padding: 14px;
    margin: 12px 0 18px;
    text-align: center;
  }

  /* ===== ìº˜ë¦°ë” ===== */
  .calendar {
    background: #fff;
    border-radius: 18px;
    padding: 14px;
  }

  .calendar-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .days {
    margin-top: 10px;
    display: grid;
    grid-template-columns: repeat(7, 1fr);
    gap: 6px;
    font-size: 12px;
    text-align: center;
  }

  .day {
  padding: 6px 0;
  border-radius: 6px;
  position: relative;
  cursor: default;
  }

  .mark {
    background: #e1ebff;
    font-weight: 600;
  }

  .day span {
    font-size: 10px;
    display: block;
  }

  /* ===== Anniversary ===== */
  h3 {
    margin-top: 22px;
  }

  #annivList {
    list-style: none;
    padding: 0;
    margin: 8px 0;
  }

  #annivList li {
    margin-bottom: 6px;
    cursor: pointer;
  }

  #detail {
    margin-top: 14px;
    background: #fff;
    border-radius: 14px;
    padding: 12px;
  }
  #memoBox {
  background: #fff;
  border-radius: 16px;
  padding: 12px;
  margin-top: 10px;
}

#memoList {
  max-height: 180px;
  overflow-y: auto;
  font-size: 13px;
  margin-bottom: 8px;
}

.memo {
  margin-bottom: 8px;
  padding: 6px 8px;
  border-radius: 10px;
  background: #f6f6f6;
  position: relative;
}

.memo-time {
  font-size: 10px;
  color: #888;
}

.memo-delete {
  position: absolute;
  top: 6px;
  right: 8px;
  cursor: pointer;
  font-size: 12px;
  opacity: 0.6;
}

.memo-delete:hover {
  opacity: 1;
}

.memo-input {
  display: flex;
  gap: 6px;
}

.memo-input input {
  flex: 1;
  padding: 6px 10px;
  border-radius: 12px;
  border: 1px solid #ccc;
  font-size: 13px;
}

.memo-input button {
  border-radius: 12px;
  padding: 6px 12px;
}

#snow {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none; /* í´ë¦­ ë°©í•´ X */
  z-index: 5;
}

body.night {
  background: #0f1220;
  color: #cfd3ff;
}

body.night .calendar,
body.night .dday,
body.night #memoBox,
body.night #detail {
  background: #1b1f3a;
  color: #e6e6f0;
}

#themeBtn {
  margin: 10px 0;
  padding: 6px 14px;
  border-radius: 16px;
  border: none;
  cursor: pointer;
}

/* ğŸŒ™ ë°¤ ëª¨ë“œ ìº˜ë¦°ë” ê¸°ë…ì¼ ê°€ë…ì„± ê°œì„  */
body.night .day.mark {
  background: #2a2f5a;   /* ì–´ë‘ìš´ ë¸”ë£¨ */
  color: #ffffff;       /* ê¸€ì ì„ ëª…í•˜ê²Œ */
}

body.night .day.mark span {
  opacity: 0.9;
}

/* ğŸŒ™ ë°¤ ëª¨ë“œ ë©”ëª¨ì°½ ê°€ë…ì„± ê°œì„  */
body.night .memo {
  background: #2a2f5a;   /* ìº˜ë¦°ë” ê¸°ë…ì¼ ì¹¸ê³¼ ë™ì¼ í†¤ */
  color: #ffffff;
}

body.night #memoBox {
  background: #1b1f3a;
}

body.night .memo-input input {
  background: #2a2f5a;
  color: #ffffff;
  border: 1px solid #3a4080;
}

body.night .memo-input input::placeholder {
  color: #b8bcff;
}

/* ğŸŒ™ ë°¤ ëª¨ë“œ â€“ ìº˜ë¦°ë” í™”ì‚´í‘œ ë²„íŠ¼ */
body.night .calendar-header button {
  background: #2a2f5a;
  color: #ffffff;
  border: none;
}

/* hover ì‹œ ì‚´ì§ ë°ê²Œ */
body.night .calendar-header button:hover {
  background: #3a4080;
}

/* ğŸŒ™ ë°¤ ëª¨ë“œ â€“ í…Œë§ˆ ì „í™˜ ë²„íŠ¼ (ğŸŒ/ğŸŒ™) */
body.night #themeBtn {
  background: #2a2f5a;
  color: #ffffff;
  border: none;
}

/* hover íš¨ê³¼ */
body.night #themeBtn:hover {
  background: #3a4080;
}

/* âœ… ê¸°ë…ì¼(mark) ìˆëŠ” ë‚ ì§œë§Œ ë§í’ì„  í‘œì‹œ */
.day.mark:hover::after {
  content: attr(data-text);
  position: absolute;
  left: 50%;
  bottom: -34px;
  transform: translateX(-50%);
  background: #333;
  color: #fff;
  padding: 4px 7px;
  border-radius: 6px;
  font-size: 10px;
  white-space: nowrap;
  z-index: 50;          /* â­ ê°€ë ¤ì§ ë°©ì§€ í•µì‹¬ */
}

.day.mark[data-text=""]::after {
  display: none;
}

</style>
</head>

<body>
<canvas id="snow"></canvas>

<!-- ===== ì¸íŠ¸ë¡œ ===== -->
<div id="intro" class="center">
  <h1>ëˆˆì€ ì–¸ì œê¹Œì§€ë‚˜ ë‚´ë¦´ê¹Œ?</h1>
  <div class="button-row">
    <button onclick="enterHome()">Yes</button>
    <button onclick="showNo()">No</button>
  </div>
  <p id="noText" class="hidden">ëˆˆì€ ê²°êµ­ ë…¹ì•„ë²„ë ¤.</p>
</div>

<!-- ===== í™ˆ ===== -->
<div id="home" class="hidden">
  <h2>Our Winter â„ï¸</h2>

  <button id="themeBtn" onclick="toggleTheme()">ğŸŒ™</button>

  <div class="dday" id="ddayBox"></div>

  <div class="calendar">
    <div class="calendar-header">
      <button onclick="moveMonth(-1)">&lt;</button>
      <strong id="monthTitle"></strong>
      <button onclick="moveMonth(1)">&gt;</button>
    </div>
    <div class="days" id="calendar"></div>
  </div>

  <h3>Anniversary</h3>
  <ul id="annivList"></ul>

  <div id="detail" class="hidden"></div>
  <h3>Memo ğŸ’¬</h3>

<div id="memoBox">
  <div id="memoList"></div>
  <div class="memo-input">
    <input type="text" id="memoInput" placeholder="í•  ì¼ì€ ì—¬ê¸° ì¨ë‘ì." />
    <button onclick="addMemo()">ì „ì†¡</button>
  </div>
</div>

</div>

<script>
  /* ===== ê¸°ë³¸ ë‚ ì§œ ===== */
  const startDate = new Date(2023, 1, 17); // 2023-02-17 = 1ì¼
  const birthdays = [
    { m: 10, d: 30, text: "ğŸ‚ ì„œì˜¬ ìƒì¼" },
    { m: 6, d: 3, text: "ğŸ‚ í˜„ìš° ìƒì¼" }
  ];

  let current = new Date();

  /* ===== ì¸íŠ¸ë¡œ ===== */
  function enterHome() {
  document.getElementById("intro").style.display = "none";
  document.getElementById("home").classList.remove("hidden");

  updateDday();
  renderCalendar();
}

  function showNo() {
    document.getElementById("noText").classList.remove("hidden");
  }

  /* ===== D-Day ===== */
  function updateDday() {
    const today = new Date();
    const days = Math.floor((today - startDate) / 86400000) + 1;
    document.getElementById("ddayBox").innerHTML =
      `<strong>D+${days}</strong><br>ëˆˆì´ ë‚´ë¦° ì§€ ${days}ì¼`;
  }

  /* ===== ìº˜ë¦°ë” ì´ë™ ===== */
  function moveMonth(diff) {
    current.setMonth(current.getMonth() + diff);
    renderCalendar();
  }

  /* ===== ìº˜ë¦°ë” ë Œë” ===== */
  function renderCalendar() {
    const cal = document.getElementById("calendar");
    const list = document.getElementById("annivList");
    const detail = document.getElementById("detail");

    cal.innerHTML = "";
    list.innerHTML = "";
    detail.classList.add("hidden");

    const y = current.getFullYear();
    const m = current.getMonth();

    document.getElementById("monthTitle").innerText = `${y}ë…„ ${m + 1}ì›”`;

    "ì¼ì›”í™”ìˆ˜ëª©ê¸ˆí† ".split("").forEach(d => {
      cal.innerHTML += `<div>${d}</div>`;
    });

    const firstDay = new Date(y, m, 1).getDay();
    const lastDate = new Date(y, m + 1, 0).getDate();

    for (let i = 0; i < firstDay; i++) cal.innerHTML += `<div></div>`;

    for (let d = 1; d <= lastDate; d++) {
      const cellDate = new Date(y, m, d);
      let label = "";
      let icon = "";

      // ì‚¬ê·„ ë‚ 
      if (cellDate.getTime() === startDate.getTime()) {
        label = "â¤ï¸ ì‚¬ê·„ ë‚  (1ì¼)";
        icon = "â¤ï¸";
      }

      // ìƒì¼
      birthdays.forEach(b => {
        if (b.m === m && b.d === d) {
          label = b.text;
          icon = "ğŸ‚";
        }
      });

      // 100ì¼ ë‹¨ìœ„
      const days = Math.floor((cellDate - startDate) / 86400000) + 1;
      if (days > 1 && days % 100 === 0) {
        label = `â„ï¸ ${days}ì¼`;
        icon = "â„ï¸";
        list.innerHTML += `<li onclick="showDetail('${days}ì¼','${cellDate.toLocaleDateString()}')">â„ï¸ ${days}ì¼</li>`;
      }

      // ì£¼ë…„
      if (cellDate.getDate() === startDate.getDate() &&
          cellDate.getMonth() === startDate.getMonth() &&
          cellDate.getFullYear() > startDate.getFullYear()) {
        const yearDiff = cellDate.getFullYear() - startDate.getFullYear();
        label = `ğŸ’ ${yearDiff}ì£¼ë…„`;
        icon = "ğŸ’";
        list.innerHTML += `<li onclick="showDetail('${yearDiff}ì£¼ë…„','${cellDate.toLocaleDateString()}')">ğŸ’ ${yearDiff}ì£¼ë…„</li>`;
      }

      cal.innerHTML += `
        <div class="day ${label ? "mark" : ""}" data-text="${label}">
          ${d}
          <span>${icon}</span>
        </div>
      `;
    }
  }

  /* ===== ìƒì„¸ ===== */
  function showDetail(title, date) {
    const box = document.getElementById("detail");
    box.classList.remove("hidden");
    box.innerHTML = `
      <h4>${title}</h4>
      <p>${date}</p>
      <p>ğŸ“¸ ì—¬ê¸°ì— ì‚¬ì§„ì„ ë„£ì„ ìˆ˜ ìˆì–´ìš”</p>
    `;
  }
  /* ===== ë©”ëª¨ (ì±„íŒ…í˜•) ===== */
const memoListEl = document.getElementById("memoList");
const memoInput = document.getElementById("memoInput");

let memos = JSON.parse(localStorage.getItem("memos") || "[]");

function renderMemos() {
  memoListEl.innerHTML = "";
  memos.forEach((m, index) => {
    memoListEl.innerHTML += `
      <div class="memo">
        <span class="memo-delete" onclick="deleteMemo(${index})">ğŸ—‘</span>
        <div>${m.text}</div>
        <div class="memo-time">${m.time}</div>
      </div>
    `;
  });
  memoListEl.scrollTop = memoListEl.scrollHeight;
}

function addMemo() {
  const text = memoInput.value.trim();
  if (!text) return;

  const time = new Date().toLocaleString();
  memos.push({ text, time });
  localStorage.setItem("memos", JSON.stringify(memos));

  memoInput.value = "";
  renderMemos();
}

function deleteMemo(index) {
  memos.splice(index, 1);
  localStorage.setItem("memos", JSON.stringify(memos));
  renderMemos();
}

memoInput.addEventListener("keydown", e => {
  if (e.key === "Enter") addMemo();
});

renderMemos();

/* ===== ëˆˆ íš¨ê³¼ ===== */
const canvas = document.getElementById("snow");
const ctx = canvas.getContext("2d");

let w, h;
let snowflakes = [];
let snowCount = 80;      // ê¸°ë³¸ ëˆˆ ê°œìˆ˜
let snowSpeed = 1;      // ê¸°ë³¸ ì†ë„

function resizeSnow() {
  w = canvas.width = window.innerWidth;
  h = canvas.height = window.innerHeight;
}
window.addEventListener("resize", resizeSnow);
resizeSnow();

function createSnow() {
  snowflakes = [];
  for (let i = 0; i < snowCount; i++) {
    snowflakes.push({
      x: Math.random() * w,
      y: Math.random() * h,
      r: Math.random() * 3 + 1,
      d: Math.random() + 1
    });
  }
}
createSnow();

function drawSnow() {
  ctx.clearRect(0, 0, w, h);
  ctx.fillStyle = "rgba(255, 255, 255, 0.8)";
  ctx.beginPath();

  snowflakes.forEach(f => {
    ctx.moveTo(f.x, f.y);
    ctx.arc(f.x, f.y, f.r, 0, Math.PI * 2);
  });

  ctx.fill();
  moveSnow();
}

function moveSnow() {
  snowflakes.forEach(f => {
    f.y += Math.pow(f.d, 2) + 0.5 * snowSpeed;
    f.x += Math.sin(f.y * 0.01);

    if (f.y > h) {
      f.y = -10;
      f.x = Math.random() * w;
    }
  });
}

setInterval(drawSnow, 33);

function toggleTheme() {
  document.body.classList.toggle("night");

  const isNight = document.body.classList.contains("night");
  localStorage.setItem("theme", isNight ? "night" : "day");

  const btn = document.getElementById("themeBtn");
  btn.textContent = isNight ? "â˜€ï¸" : "ğŸŒ™";
}

const savedTheme = localStorage.getItem("theme");
if (savedTheme === "night") {
  document.body.classList.add("night");
  document.getElementById("themeBtn").textContent = "â˜€ï¸";
}

</script>

</body>
</html>
